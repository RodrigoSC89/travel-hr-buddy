# ðŸ—ï¸ Architecture Overview

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT (Browser/PWA)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   React 18  â”‚  â”‚  TanStack   â”‚  â”‚  Tailwind   â”‚  â”‚ TypeScript â”‚ â”‚
â”‚  â”‚   + Vite    â”‚  â”‚   Query     â”‚  â”‚    CSS      â”‚  â”‚   Strict   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚
          â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SERVICE LAYER                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   API       â”‚  â”‚   Auth      â”‚  â”‚  Storage    â”‚                  â”‚
â”‚  â”‚  Services   â”‚  â”‚  Service    â”‚  â”‚  Service    â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SUPABASE BACKEND                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostgreSQL  â”‚  â”‚    Auth     â”‚  â”‚   Storage   â”‚  â”‚   Edge     â”‚ â”‚
â”‚  â”‚  + RLS      â”‚  â”‚   (JWT)     â”‚  â”‚  (Buckets)  â”‚  â”‚ Functions  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTERNAL SERVICES                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   OpenAI    â”‚  â”‚   Sentry    â”‚  â”‚  Maritime   â”‚                  â”‚
â”‚  â”‚   GPT-4o    â”‚  â”‚   Errors    â”‚  â”‚    APIs     â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Directory Structure Map

```
nautilus-one/
â”‚
â”œâ”€â”€ ðŸ“ src/                      # Source code
â”‚   â”œâ”€â”€ ðŸ“ components/           # React components
â”‚   â”‚   â”œâ”€â”€ ðŸ“ ui/               # Base UI (shadcn)
â”‚   â”‚   â”œâ”€â”€ ðŸ“ common/           # Shared components
â”‚   â”‚   â”œâ”€â”€ ðŸ“ layouts/          # Page layouts
â”‚   â”‚   â””â”€â”€ ðŸ“ [feature]/        # Feature-specific
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ pages/                # Route pages
â”‚   â”‚   â”œâ”€â”€ Index.tsx            # Home page
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx        # Main dashboard
â”‚   â”‚   â”œâ”€â”€ Crew.tsx             # Crew management
â”‚   â”‚   â””â”€â”€ ...                  # Other pages
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ hooks/                # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ use-auth.ts          # Authentication
â”‚   â”‚   â”œâ”€â”€ use-mobile.ts        # Mobile detection
â”‚   â”‚   â””â”€â”€ index.ts             # Exports
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ services/             # API layer
â”‚   â”‚   â”œâ”€â”€ api.ts               # Base client
â”‚   â”‚   â””â”€â”€ [resource].ts        # Resource services
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ lib/                  # Core utilities
â”‚   â”‚   â”œâ”€â”€ utils.ts             # Helper functions
â”‚   â”‚   â”œâ”€â”€ supabase.ts          # Supabase client
â”‚   â”‚   â””â”€â”€ ðŸ“ performance/      # Performance utils
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ types/                # TypeScript types
â”‚   â”‚   â””â”€â”€ index.ts             # Type definitions
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ integrations/         # External integrations
â”‚   â”‚   â””â”€â”€ ðŸ“ supabase/         # Supabase types
â”‚   â”‚
â”‚   â”œâ”€â”€ App.tsx                  # Main app component
â”‚   â”œâ”€â”€ main.tsx                 # Entry point
â”‚   â””â”€â”€ index.css                # Global styles + tokens
â”‚
â”œâ”€â”€ ðŸ“ supabase/                 # Backend
â”‚   â”œâ”€â”€ ðŸ“ functions/            # Edge Functions
â”‚   â”‚   â”œâ”€â”€ ðŸ“ ai-engine/        # AI processing
â”‚   â”‚   â”œâ”€â”€ ðŸ“ send-email/       # Email service
â”‚   â”‚   â””â”€â”€ ...                  # Other functions
â”‚   â”‚
â”‚   â””â”€â”€ ðŸ“ migrations/           # Database migrations
â”‚
â”œâ”€â”€ ðŸ“ docs/                     # Documentation
â”‚   â”œâ”€â”€ README.md                # Docs index
â”‚   â”œâ”€â”€ ðŸ“ api/                  # API docs
â”‚   â”œâ”€â”€ ðŸ“ development/          # Dev guides
â”‚   â”œâ”€â”€ ðŸ“ deployment/           # Deploy guides
â”‚   â””â”€â”€ ðŸ“ handoff/              # Handoff docs
â”‚
â”œâ”€â”€ ðŸ“ tests/                    # Test files
â”œâ”€â”€ ðŸ“ e2e/                      # E2E tests
â”œâ”€â”€ ðŸ“ public/                   # Static assets
â”‚
â”œâ”€â”€ ðŸ“„ README.md                 # Project overview
â”œâ”€â”€ ðŸ“„ CONTRIBUTING.md           # Contribution guide
â”œâ”€â”€ ðŸ“„ SECURITY.md               # Security policy
â””â”€â”€ ðŸ“„ package.json              # Dependencies
```

## Data Flow

```
User Action â†’ Component â†’ Hook â†’ Service â†’ Supabase â†’ Database
                                    â†“
                              Edge Function
                                    â†“
                            External API/AI
```

## Key Patterns

### 1. Component Pattern
```tsx
// Smart component (container)
const CrewList = () => {
  const { data } = useCrewMembers();
  return <CrewTable data={data} />;
};

// Dumb component (presentational)
const CrewTable = ({ data }) => (
  <Table>{/* render data */}</Table>
);
```

### 2. Hook Pattern
```tsx
// Custom hook for data fetching
const useCrewMembers = () => {
  return useQuery({
    queryKey: ['crew'],
    queryFn: crewService.getAll,
  });
};
```

### 3. Service Pattern
```tsx
// Service encapsulates API calls
const crewService = {
  getAll: () => supabase.from('crew_members').select('*'),
  getById: (id) => supabase.from('crew_members').select('*').eq('id', id),
};
```

## Security Layers

1. **Frontend**: Input validation, XSS prevention
2. **API**: Rate limiting, authentication
3. **Database**: RLS policies, encryption
4. **Network**: HTTPS, CSP headers

/**
 * PATCH 903: Global Contrast Emergency Fix
 * Corrige problemas de contraste em todo o sistema Nautilus One
 * 
 * Este arquivo aplica correções GLOBAIS para garantir legibilidade
 */

/* ============================================
   CORREÇÕES GLOBAIS DE CONTRASTE
   ============================================ */

/* FORÇA texto escuro em fundos claros - LIGHT MODE */
:root,
[data-theme="light"],
.light {
  /* Texto Principal - SEMPRE escuro no modo claro */
  --foreground: 220 87% 8%;
  --card-foreground: 220 87% 8%;
  --popover-foreground: 220 87% 8%;
  --muted-foreground: 220 15% 30%;
  --secondary-foreground: 220 87% 8%;
  --accent-foreground: 0 0% 100%;
  
  /* Backgrounds - Garantir que sejam claros */
  --background: 0 0% 100%;
  --card: 0 0% 100%;
  --popover: 0 0% 100%;
  --secondary: 220 13% 91%;
  --muted: 220 13% 95%;
}

/* FORÇA texto claro em fundos escuros - DARK MODE */
.dark,
[data-theme="dark"] {
  /* Texto Principal - SEMPRE claro no modo escuro */
  --foreground: 0 0% 98%;
  --card-foreground: 0 0% 98%;
  --popover-foreground: 0 0% 95%;
  --muted-foreground: 220 20% 75%;
  --secondary-foreground: 220 87% 8%;
  --accent-foreground: 0 0% 100%;
  
  /* Backgrounds - Garantir que sejam escuros */
  --background: 222 47% 11%;
  --card: 220 39% 13%;
  --popover: 220 39% 15%;
  --secondary: 220 26% 76%;
  --muted: 220 84% 12%;
}

/* ============================================
   CORREÇÕES DE TEXTO - ELEMENTOS COMUNS
   ============================================ */

/* Títulos e Headings */
h1, h2, h3, h4, h5, h6,
.text-foreground,
[class*="CardTitle"],
[class*="DialogTitle"],
[class*="AlertTitle"] {
  color: hsl(var(--foreground)) !important;
}

/* Parágrafos e texto body */
p:not([class*="text-"]),
.text-card-foreground,
.text-popover-foreground {
  color: hsl(var(--foreground));
}

/* Texto muted - garantir contraste mínimo 4.5:1 */
.text-muted-foreground,
.text-muted,
[class*="text-gray-"],
[class*="text-slate-"] {
  color: hsl(var(--muted-foreground)) !important;
}

/* ============================================
   CORREÇÕES DE CARDS
   ============================================ */

/* Cards básicos */
.card,
[class*="Card"],
.bg-card {
  background-color: hsl(var(--card));
  color: hsl(var(--card-foreground));
}

/* Garantir texto visível dentro de cards */
.card *,
[class*="Card"] * {
  color: inherit;
}

.card h1, .card h2, .card h3, .card h4, .card h5, .card h6,
[class*="Card"] h1, [class*="Card"] h2, [class*="Card"] h3 {
  color: hsl(var(--card-foreground)) !important;
}

.card p, .card span:not([class*="text-"]),
[class*="Card"] p, [class*="Card"] span:not([class*="text-"]) {
  color: hsl(var(--card-foreground));
}

/* ============================================
   CORREÇÕES DE LABELS E FORMULÁRIOS
   ============================================ */

/* Labels sempre legíveis */
label,
.label,
[class*="Label"] {
  color: hsl(var(--foreground)) !important;
  font-weight: 500;
}

/* Placeholder com contraste adequado */
input::placeholder,
textarea::placeholder {
  color: hsl(220 10% 50%) !important;
  opacity: 1;
}

.dark input::placeholder,
.dark textarea::placeholder {
  color: hsl(220 10% 60%) !important;
}

/* Inputs com texto visível */
input:not([type="checkbox"]):not([type="radio"]),
textarea,
select {
  color: hsl(var(--foreground)) !important;
  background-color: hsl(var(--background)) !important;
}

.dark input:not([type="checkbox"]):not([type="radio"]),
.dark textarea,
.dark select {
  background-color: hsl(220 39% 13%) !important;
}

/* ============================================
   CORREÇÕES DE TABELAS
   ============================================ */

/* Tabelas com texto legível */
table th {
  color: hsl(var(--foreground)) !important;
  font-weight: 600 !important;
  background-color: hsl(var(--muted));
}

table td {
  color: hsl(var(--foreground)) !important;
}

.dark table th {
  background-color: hsl(220 39% 16%) !important;
}

/* ============================================
   CORREÇÕES DE BADGES E STATUS
   ============================================ */

/* Badges com texto garantido */
.badge,
[class*="Badge"] {
  font-weight: 500 !important;
}

/* Badge outline precisa de texto visível */
.badge-outline,
[class*="badge"][class*="outline"],
[data-variant="outline"] {
  color: hsl(var(--foreground)) !important;
  border-color: hsl(var(--border)) !important;
}

/* ============================================
   CORREÇÕES DE SIDEBAR E NAVEGAÇÃO
   ============================================ */

/* Sidebar text always visible */
[data-sidebar] * {
  color: inherit;
}

[data-sidebar="menu-button"],
[data-sidebar="menu-sub-button"] {
  color: hsl(var(--sidebar-foreground)) !important;
}

.dark [data-sidebar="menu-button"],
.dark [data-sidebar="menu-sub-button"] {
  color: hsl(0 0% 90%) !important;
}

/* ============================================
   CORREÇÕES DE DROPDOWN E POPOVER
   ============================================ */

/* Dropdowns SEMPRE com fundo sólido */
[role="menu"],
[role="listbox"],
.dropdown-content,
[class*="DropdownMenu"],
[class*="SelectContent"],
[class*="PopoverContent"],
[class*="DialogContent"],
[class*="MenuContent"] {
  background-color: hsl(var(--popover)) !important;
  color: hsl(var(--popover-foreground)) !important;
  z-index: 50;
}

[role="menuitem"],
[role="option"] {
  color: hsl(var(--popover-foreground)) !important;
}

.dark [role="menu"],
.dark [role="listbox"],
.dark .dropdown-content,
.dark [class*="DropdownMenu"],
.dark [class*="SelectContent"] {
  background-color: hsl(220 39% 15%) !important;
}

/* ============================================
   CORREÇÕES DE ALERT E TOAST
   ============================================ */

/* Alerts com texto visível */
[role="alert"] {
  color: hsl(var(--foreground)) !important;
}

/* Toast com contraste */
[class*="Toast"],
.toast {
  color: hsl(var(--foreground)) !important;
}

/* ============================================
   CORREÇÕES DE TEXTO SECUNDÁRIO
   ============================================ */

/* Descrições e texto secundário - mínimo 4.5:1 */
.description,
.text-description,
[class*="Description"] {
  color: hsl(var(--muted-foreground)) !important;
}

/* Texto small/extra-small com peso aumentado para contraste */
.text-xs,
.text-sm {
  font-weight: 450;
}

/* ============================================
   DARK MODE ESPECÍFICO
   ============================================ */

.dark {
  /* Garantir que todos os textos sejam claros */
  color-scheme: dark;
}

.dark * {
  /* Herdar cor do pai por padrão */
  color: inherit;
}

/* Elementos que precisam de cor forçada no dark mode */
.dark h1, .dark h2, .dark h3, .dark h4, .dark h5, .dark h6 {
  color: hsl(0 0% 98%) !important;
}

.dark p:not([class*="text-"]) {
  color: hsl(0 0% 93%);
}

/* ============================================
   LIGHT MODE ESPECÍFICO
   ============================================ */

:root:not(.dark) {
  /* Garantir que todos os textos sejam escuros */
  color-scheme: light;
}

:root:not(.dark) h1, 
:root:not(.dark) h2, 
:root:not(.dark) h3, 
:root:not(.dark) h4, 
:root:not(.dark) h5, 
:root:not(.dark) h6 {
  color: hsl(220 87% 8%) !important;
}

:root:not(.dark) p:not([class*="text-"]) {
  color: hsl(220 87% 8%);
}

/* ============================================
   CORREÇÕES DE GRADIENTES EM TEXTO
   ============================================ */

/* Remover gradientes problemáticos em texto */
.bg-clip-text {
  -webkit-text-fill-color: currentColor !important;
  background: none !important;
  color: hsl(var(--foreground)) !important;
}

/* ============================================
   OVERRIDE DE CLASSES text-white/text-black
   ============================================ */

/* Garantir que text-white funcione apenas em backgrounds escuros */
.bg-primary .text-white,
.bg-destructive .text-white,
.bg-success .text-white,
[class*="bg-azure-"] .text-white {
  color: white !important;
}

/* Garantir que text-black funcione apenas em backgrounds claros */
.bg-white .text-black,
.bg-secondary .text-black,
.bg-muted .text-black {
  color: black !important;
}

/* ============================================
   SAFE FALLBACKS
   ============================================ */

/* Se nenhuma cor for definida, usar foreground */
* {
  --tw-text-opacity: 1;
}

/* Forçar herança de cor em containers */
.container,
.wrapper,
main,
section,
article,
aside {
  color: hsl(var(--foreground));
}

/**
 * ULTIMATE CONTRAST FIX - Nautilus One
 * Correção definitiva de contraste para todo o sistema
 * WCAG AAA Compliance (7:1 ratio)
 * 
 * Este arquivo DEVE ser importado por último para garantir override correto
 */

/* ============================================
   RESET DE CORES PROBLEMÁTICAS
   ============================================ */

/* Remove text-white em fundos claros - CRÍTICO */
:root:not(.dark) .text-white:not([class*="bg-"]):not([class*="from-"]) {
  color: hsl(var(--foreground)) !important;
}

/* Remove text-gray-* problemáticos no light mode */
:root:not(.dark) [class*="text-gray-3"],
:root:not(.dark) [class*="text-gray-4"],
:root:not(.dark) [class*="text-gray-5"],
:root:not(.dark) [class*="text-slate-3"],
:root:not(.dark) [class*="text-slate-4"],
:root:not(.dark) [class*="text-slate-5"] {
  color: hsl(var(--muted-foreground)) !important;
}

/* Remove text-gray-* problemáticos no dark mode */
.dark [class*="text-gray-6"],
.dark [class*="text-gray-7"],
.dark [class*="text-gray-8"],
.dark [class*="text-slate-6"],
.dark [class*="text-slate-7"],
.dark [class*="text-slate-8"] {
  color: hsl(var(--muted-foreground)) !important;
}

/* ============================================
   GRADIENTES COM TEXTO LEGÍVEL
   ============================================ */

/* Gradientes escuros DEVEM ter texto claro */
[class*="from-primary"][class*="to-"],
[class*="from-blue-"][class*="to-"],
[class*="from-purple-"][class*="to-"],
[class*="from-indigo-"][class*="to-"],
[class*="from-violet-"][class*="to-"],
[class*="bg-gradient-to-"][class*="from-primary"],
[class*="bg-gradient-to-"][class*="from-blue-"],
[class*="bg-gradient-to-"][class*="from-purple-"] {
  color: white !important;
}

/* Gradientes dentro - todos os filhos herdam cor */
[class*="from-primary"][class*="to-"] *,
[class*="from-blue-5"][class*="to-"] *,
[class*="from-blue-6"][class*="to-"] *,
[class*="from-blue-7"][class*="to-"] *,
[class*="from-purple-5"][class*="to-"] *,
[class*="from-purple-6"][class*="to-"] * {
  color: inherit;
}

/* Gradientes claros precisam de texto escuro */
[class*="from-white"],
[class*="from-gray-1"],
[class*="from-gray-2"],
[class*="from-slate-1"],
[class*="from-slate-2"],
[class*="from-background"] {
  color: hsl(var(--foreground)) !important;
}

/* ============================================
   BADGES COM CONTRASTE GARANTIDO
   ============================================ */

/* Badges com background escuro */
.bg-green-500,
.bg-green-600,
.bg-green-700,
.bg-blue-500,
.bg-blue-600,
.bg-blue-700,
.bg-red-500,
.bg-red-600,
.bg-red-700,
.bg-purple-500,
.bg-purple-600,
.bg-purple-700,
.bg-orange-500,
.bg-orange-600,
.bg-primary,
.bg-destructive,
.bg-success,
.bg-danger {
  color: white !important;
}

/* Badges com background claro */
.bg-green-100,
.bg-green-200,
.bg-blue-100,
.bg-blue-200,
.bg-red-100,
.bg-red-200,
.bg-yellow-100,
.bg-yellow-200,
.bg-orange-100,
.bg-orange-200,
.bg-gray-100,
.bg-gray-200,
.bg-slate-100,
.bg-slate-200 {
  color: hsl(220 87% 8%) !important;
}

/* Badges semi-transparentes - garantir contraste */
[class*="bg-green-500/10"],
[class*="bg-blue-500/10"],
[class*="bg-red-500/10"],
[class*="bg-purple-500/10"],
[class*="bg-orange-500/10"],
[class*="bg-yellow-500/10"],
[class*="bg-gray-500/10"] {
  color: hsl(var(--foreground)) !important;
}

.dark [class*="bg-green-500/10"],
.dark [class*="bg-blue-500/10"],
.dark [class*="bg-red-500/10"],
.dark [class*="bg-purple-500/10"],
.dark [class*="bg-orange-500/10"],
.dark [class*="bg-yellow-500/10"],
.dark [class*="bg-gray-500/10"] {
  color: hsl(0 0% 95%) !important;
}

/* ============================================
   CARDS E CONTAINERS
   ============================================ */

/* Card padrão */
.bg-card,
[data-slot="card"],
.rounded-lg.border {
  background-color: hsl(var(--card)) !important;
  color: hsl(var(--card-foreground)) !important;
}

/* Texto dentro de cards */
.bg-card h1, .bg-card h2, .bg-card h3, .bg-card h4, .bg-card h5, .bg-card h6,
.bg-card p, .bg-card span, .bg-card div {
  color: inherit;
}

/* Cards com gradiente */
[class*="bg-gradient-to-br"][class*="from-"][class*="/10"],
[class*="bg-gradient-to-r"][class*="from-"][class*="/10"],
[class*="bg-gradient-to-"][class*="from-"][class*="/5"] {
  color: hsl(var(--foreground)) !important;
}

.dark [class*="bg-gradient-to-br"][class*="from-"][class*="/10"],
.dark [class*="bg-gradient-to-r"][class*="from-"][class*="/10"],
.dark [class*="bg-gradient-to-"][class*="from-"][class*="/5"] {
  color: hsl(0 0% 95%) !important;
}

/* ============================================
   TABELAS
   ============================================ */

table {
  color: hsl(var(--foreground));
}

table th {
  color: hsl(var(--foreground)) !important;
  font-weight: 600;
  background-color: hsl(var(--muted));
}

table td {
  color: hsl(var(--foreground)) !important;
}

.dark table th {
  background-color: hsl(220 39% 16%);
}

/* ============================================
   SIDEBAR E NAVEGAÇÃO
   ============================================ */

/* Sidebar text */
[data-sidebar],
.sidebar,
nav[aria-label] {
  color: hsl(var(--sidebar-foreground));
}

[data-sidebar] a,
[data-sidebar] button,
[data-sidebar] span {
  color: inherit;
}

/* Menu items ativos */
[data-sidebar] [data-active="true"],
[data-sidebar] .active,
nav [aria-current="page"] {
  color: hsl(var(--sidebar-primary-foreground)) !important;
  background-color: hsl(var(--sidebar-primary));
}

/* ============================================
   DROPDOWNS E POPOVERS - CRÍTICO
   ============================================ */

/* Forçar fundo sólido em todos os dropdowns */
[role="menu"],
[role="listbox"],
[role="dialog"],
[data-radix-popper-content-wrapper] > *,
[data-state="open"][data-side],
.popover-content,
.dropdown-content {
  background-color: hsl(var(--popover)) !important;
  color: hsl(var(--popover-foreground)) !important;
  border: 1px solid hsl(var(--border)) !important;
  z-index: 50 !important;
}

/* Items dentro de dropdowns */
[role="menuitem"],
[role="option"],
[data-radix-collection-item] {
  color: hsl(var(--popover-foreground)) !important;
}

[role="menuitem"]:hover,
[role="option"]:hover,
[data-highlighted] {
  background-color: hsl(var(--accent)) !important;
  color: hsl(var(--accent-foreground)) !important;
}

/* Dark mode dropdowns */
.dark [role="menu"],
.dark [role="listbox"],
.dark [role="dialog"],
.dark [data-radix-popper-content-wrapper] > * {
  background-color: hsl(220 39% 15%) !important;
  border-color: hsl(220 84% 20%) !important;
}

/* ============================================
   INPUTS E FORMULÁRIOS
   ============================================ */

input:not([type="checkbox"]):not([type="radio"]):not([type="range"]),
textarea,
select {
  color: hsl(var(--foreground)) !important;
  background-color: hsl(var(--background)) !important;
  border-color: hsl(var(--border)) !important;
}

.dark input:not([type="checkbox"]):not([type="radio"]):not([type="range"]),
.dark textarea,
.dark select {
  background-color: hsl(220 39% 13%) !important;
}

/* Placeholder legível */
::placeholder {
  color: hsl(220 10% 50%) !important;
  opacity: 1 !important;
}

.dark ::placeholder {
  color: hsl(220 10% 60%) !important;
}

/* Labels sempre visíveis */
label,
.label {
  color: hsl(var(--foreground)) !important;
  font-weight: 500;
}

/* ============================================
   TEXTO SECUNDÁRIO E MUTED
   ============================================ */

/* Muted text com contraste mínimo 4.5:1 */
.text-muted-foreground,
.text-muted,
[class*="text-gray-5"]:not(.dark *),
[class*="text-slate-5"]:not(.dark *) {
  color: hsl(220 15% 35%) !important;
}

.dark .text-muted-foreground,
.dark .text-muted,
.dark [class*="text-gray-4"],
.dark [class*="text-slate-4"] {
  color: hsl(220 20% 70%) !important;
}

/* Descrições */
.text-sm.text-muted-foreground,
[class*="Description"],
.description {
  color: hsl(var(--muted-foreground)) !important;
}

/* ============================================
   BOTÕES
   ============================================ */

/* Botão primário */
.bg-primary,
button.bg-primary,
[class*="btn-primary"] {
  background-color: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
}

/* Botão outline */
.border.bg-transparent,
[class*="btn-outline"],
button[data-variant="outline"] {
  background-color: transparent !important;
  color: hsl(var(--foreground)) !important;
  border-color: hsl(var(--border)) !important;
}

/* Botão ghost */
[class*="btn-ghost"],
button[data-variant="ghost"] {
  color: hsl(var(--foreground)) !important;
}

/* ============================================
   ALERTAS E TOASTS
   ============================================ */

[role="alert"] {
  color: hsl(var(--foreground)) !important;
}

[role="alert"][class*="destructive"],
[role="alert"].bg-destructive {
  color: white !important;
}

/* Toast */
[data-sonner-toast] {
  background-color: hsl(var(--card)) !important;
  color: hsl(var(--card-foreground)) !important;
}

.dark [data-sonner-toast] {
  background-color: hsl(220 39% 15%) !important;
}

/* ============================================
   ÍCONES
   ============================================ */

/* Ícones devem herdar cor do texto */
svg:not([fill]):not([class*="text-"]) {
  color: inherit;
}

/* Ícones com cor específica - manter */
svg[class*="text-green"],
svg[class*="text-blue"],
svg[class*="text-red"],
svg[class*="text-yellow"],
svg[class*="text-orange"],
svg[class*="text-purple"] {
  /* Manter a cor definida */
}

/* ============================================
   CORREÇÕES ESPECÍFICAS PARA COMPONENTES
   ============================================ */

/* Cards com fundo escuro (slate-900, zinc-900, etc.) */
[class*="bg-slate-9"],
[class*="bg-zinc-9"],
[class*="bg-gray-9"],
[class*="bg-neutral-9"] {
  color: white !important;
}

[class*="bg-slate-9"] *,
[class*="bg-zinc-9"] *,
[class*="bg-gray-9"] *,
[class*="bg-neutral-9"] * {
  color: inherit;
}

/* Textos em seções com overlay escuro */
[class*="bg-slate-9"] .text-slate-300,
[class*="bg-slate-9"] .text-slate-400,
[class*="bg-zinc-9"] .text-zinc-300,
[class*="bg-zinc-9"] .text-zinc-400 {
  color: rgba(255, 255, 255, 0.8) !important;
}

/* Hero sections e banners escuros */
section[class*="bg-gradient"] {
  color: white;
}

section[class*="bg-gradient"] h1,
section[class*="bg-gradient"] h2,
section[class*="bg-gradient"] h3,
section[class*="bg-gradient"] p,
section[class*="bg-gradient"] span {
  color: inherit;
}

/* Cards KPI com fundo escuro */
.border-slate-800,
[class*="border-slate-8"] {
  color: white;
}

/* Muted text em fundos escuros */
[class*="bg-slate-9"] .text-muted-foreground,
[class*="bg-zinc-9"] .text-muted-foreground,
.dark .text-muted-foreground {
  color: rgba(255, 255, 255, 0.7) !important;
}

/* Slate colors específicos */
.text-slate-200 { color: #e2e8f0 !important; }
.text-slate-300 { color: #cbd5e1 !important; }
.text-slate-400 { color: #94a3b8 !important; }

.dark .text-slate-200,
.dark .text-slate-300,
.dark .text-slate-400,
[class*="bg-slate-9"] .text-slate-200,
[class*="bg-slate-9"] .text-slate-300,
[class*="bg-slate-9"] .text-slate-400 {
  color: rgba(255, 255, 255, 0.85) !important;
}

/* Zinc colors específicos */
.text-zinc-200 { color: #e4e4e7 !important; }
.text-zinc-300 { color: #d4d4d8 !important; }
.text-zinc-400 { color: #a1a1aa !important; }

.dark .text-zinc-200,
.dark .text-zinc-300,
.dark .text-zinc-400,
[class*="bg-zinc-9"] .text-zinc-200,
[class*="bg-zinc-9"] .text-zinc-300,
[class*="bg-zinc-9"] .text-zinc-400 {
  color: rgba(255, 255, 255, 0.85) !important;
}

/* Glass effect cards */
[class*="backdrop-blur"] {
  color: white;
}

[class*="backdrop-blur"] h1,
[class*="backdrop-blur"] h2,
[class*="backdrop-blur"] h3,
[class*="backdrop-blur"] p {
  color: inherit;
}

/* Border with white opacity */
[class*="border-white/"] {
  border-color: rgba(255, 255, 255, 0.1);
}

/* Background with white opacity means dark context */
[class*="bg-white/5"],
[class*="bg-white/10"],
[class*="bg-white/15"],
[class*="bg-white/20"] {
  color: white;
}

[class*="bg-white/5"] *,
[class*="bg-white/10"] *,
[class*="bg-white/15"] *,
[class*="bg-white/20"] * {
  color: inherit;
}

/* ============================================
   LIGHT MODE - TEXTOS CINZA PRECISAM CONTRASTE
   ============================================ */

:root:not(.dark) .text-slate-500,
:root:not(.dark) .text-zinc-500,
:root:not(.dark) .text-gray-500,
:root:not(.dark) .text-neutral-500 {
  color: hsl(220 15% 35%) !important;
}

:root:not(.dark) .text-slate-600,
:root:not(.dark) .text-zinc-600,
:root:not(.dark) .text-gray-600,
:root:not(.dark) .text-neutral-600 {
  color: hsl(220 15% 28%) !important;
}

/* ============================================
   DARK MODE - TEXTOS CINZA PRECISAM CONTRASTE
   ============================================ */

.dark .text-slate-500,
.dark .text-zinc-500,
.dark .text-gray-500,
.dark .text-neutral-500 {
  color: hsl(220 15% 70%) !important;
}

.dark .text-slate-600,
.dark .text-zinc-600,
.dark .text-gray-600,
.dark .text-neutral-600 {
  color: hsl(220 15% 75%) !important;
}

/* ============================================
   OVERRIDE FINAL - FORÇA CONTRASTE
   ============================================ */

/* Light mode - texto DEVE ser escuro */
:root:not(.dark) {
  color: hsl(220 87% 8%);
}

:root:not(.dark) body {
  color: hsl(220 87% 8%);
  background-color: hsl(0 0% 100%);
}

/* Dark mode - texto DEVE ser claro */
.dark {
  color: hsl(0 0% 95%);
}

.dark body {
  color: hsl(0 0% 95%);
  background-color: hsl(222 47% 11%);
}

/* Headings - SEMPRE com contraste máximo */
h1, h2, h3, h4, h5, h6 {
  color: hsl(var(--foreground)) !important;
}

/* Parágrafos - herdar ou usar foreground */
p {
  color: inherit;
}

p:not([class]) {
  color: hsl(var(--foreground));
}

/* ============================================
   COMPONENTES ESPECÍFICOS DO NAUTILUS
   ============================================ */

/* Dashboard cards */
.dashboard-card,
[class*="metric-card"],
[class*="stats-card"] {
  background-color: hsl(var(--card));
  color: hsl(var(--card-foreground));
}

/* Status indicators */
[class*="status-"] {
  font-weight: 600;
}

/* Module headers */
.module-header,
[class*="page-header"] {
  color: hsl(var(--foreground));
}

/* Data displays */
.data-value,
.metric-value,
[class*="value-display"] {
  color: hsl(var(--foreground)) !important;
  font-weight: 600;
}

/* Chart labels */
.recharts-text,
.chart-label {
  fill: hsl(var(--foreground)) !important;
}

.dark .recharts-text,
.dark .chart-label {
  fill: hsl(0 0% 90%) !important;
}

/* ============================================
   ACCESSIBILITY ENHANCEMENTS
   ============================================ */

/* Focus visible - anel de foco sempre visível */
:focus-visible {
  outline: 3px solid hsl(var(--ring)) !important;
  outline-offset: 2px !important;
}

/* Skip link */
.skip-link:focus {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 9999;
  background: hsl(var(--background));
  color: hsl(var(--foreground));
  padding: 1rem;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --foreground: 0 0% 0%;
    --background: 0 0% 100%;
    --border: 0 0% 0%;
  }
  
  .dark {
    --foreground: 0 0% 100%;
    --background: 0 0% 0%;
    --border: 0 0% 100%;
  }
}

/* ============================================
   PRINT STYLES
   ============================================ */

@media print {
  * {
    color: black !important;
    background: white !important;
  }
}
